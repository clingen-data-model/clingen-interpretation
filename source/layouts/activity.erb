<% wrap_layout :layout  do %>

    <%- entity = data.flattened.Type[current_page.data.id] %>

    <!-- this is primarily the Scope and Usage section -->
    <%= yield %>

    <!-- image here if available -->
    <%= image_tag entity.imageFile  %>

    <h2>Attributes</h2>

        <table class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead>
            <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Cardinality</th>
                <th>Description</th>
            </tr>
            </thead>
            <tbody>
        <% attributes_by_entity(current_page.data.id).each do |a| %>
            <tr>
                <td><%= a.name %></td>
                <td><%= a.dataType %></td>
                <td><%= a.cardinality %></td>
                <td><%= a.description %></td>
            </tr>
        <% end %>
            </tbody>
        </table>

            <h2>Inherited Attributes</h2>

        <table class="table table-striped table-bordered" cellspacing="0" width="100%">
            <thead>
            <tr>
                <th>Name</th>
                <th>Type</th>
                <th>Cardinality</th>
                <th>Inherited From</th>
                <th>Description</th>
            </tr>
            </thead>
            <tbody>
            <% parentid = data.flattened.Type[current_page.data.id].parentType %>
            <% while parentid != nil %>
                <% attributes_by_entity(parentid).each do |a| %>
                <tr>
                    <td><%= a.name %></td>
                    <td><%= a.dataType %></td>
                    <td><%= a.cardinality %></td>
                    <td><%= data.flattened.Type[parentid].name %></td>
                    <td><%= a.description %></td>
                </tr>
                <% end %>
                <% parentid = data.flattened.Type[parentid].parentType %>
            <% end %>
            </tbody>
        </table>


    <h2>Examples</h2>
    <div id="example_view"></div>
    <script>
        run_on_load = function () {return $("#example_view").JSONView(
          <%= Hash[(examples_by_type(current_page.data.id) || []).map {|ex| [ex['cg:id'], ex]}].to_json %>,
          { collapsed: true }
        )}
    </script>


<% end %>
